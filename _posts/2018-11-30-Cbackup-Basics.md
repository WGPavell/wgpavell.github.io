---
layout: post
title: Основы cBackup
date: 2018-11-30 17:00:00
categories: [Cbackup]
---

*Не прошло и месяца, как новая статья...*

![cBackup](/images/cbackup.png)

Приветствую всех, кто по какой-то неведомой случайности забрел сюда. Пишу очередную статью в своем блоге и в этот раз хочу рассказать о такой вещи, как **cBackup**. Что это и с чем это едят? Сегодня я попробую об этом рассказать. *Хотя, на деле, скорее всего, уйдет далеко не одна статья на эту систему...*

**cBackup** - это веб-приложение, предназначенное для сбора информации с сетевых устройств. Точнее, его главное предназначение - сбор конфигураций с коммутаторов и маршрутизаторов, но собирать необязательно именно конфиги. Я не буду описывать нудный процесс установки, который вы и сами без меня можете прекрасно [почитать](https://cbackup.readthedocs.io/en/latest/getting-started/install/).

![Дайджест cBackup](/images/cbackup_basics/1.png)

После установки перед предстанет нечто подобное, но только без данных. Разумеется, все *железки* вы должны будете занестив БД cBackup'а, а как это сделать - решать уже вам. Система предоставляет по крайней мере 2 способа добавления узлов: автоматически по SNMP и вручную. Добавлять узлы вручную особого труда вам не составит: пункт меню *Узлы -> Добавить вручную*. Форма данных узла выглядит следующим образом:

![Добавление узла вручную](/images/cbackup_basics/2.png)

Полей вроде бы много, но обязательны к заполнению только два: *ip* и *устройство*. Но стоп, погодите-ка, при первом использовании системы никаких устройств нет и добавить узел не получается! Как же так и что делать? Сейчас объясню. Дело в том, что cBackup собирает необходимые данные (*конфиги*), используя **telnet** или **SSH**, а также последовательность команд (для каждого вендора она разная). При чем, строки приглашения могут быть разными (*username* или *login*, например). Все эти данные можно создать отдельно и привязать к конкретной модели устройства, которую вы уже указываете при создании узла (либо же система это делает за вас на автомате). Так что необходимо проделать несколько шагов перед тем, как добавить узел в базу данных, а именно:

1. **Создать шаблон аутентификации** (*Сети и оборудование -> Шаблоны аутентификации*). Это те самые строки приглашения, о которых я говорил чуть ранее. Необходимо указать что и в какой последовательности выводится на экран, чтобы система могла правильно вписать логин и пароль, а также определить момент, когда можно вводить команды. Вот пример такого шаблона аутентификации для некоторых устройств Cisco:
> ame:
> {{telnet_login}}
> ord:
> {{telnet_password}}
> #

Обратите внимание  на текст в двойных скобках: это системные переменные, которые подставляются из реквизитов (в данном случае это логин и пароль от telnet). Вы можете описать любую необходимую последовательность для входа устройство (*лично у меня был такой случай, что именно с первого раза не входит на узел и мне пришлось дублировать строчки, чтобы снимать последний конфиг с него*).
![Шаблон аутентификации](/images/cbackup_basics/3.png)
2. **Добавить реквизиты** (*Сети и оборудование -> Реквизиты*). В них указываются необходимые данные для входа: логин-пароль для telnet/ssh, данные SNMP, а также порты, которые используются для того или иного протокола. После добавления реквизитов при редактировании справа появляется столбец, в котором можно проверить работоспособность введенных реквизитов на каком-либо узле.
![Пример реквизитов](/images/cbackup_basics/4.png)
3. **Добавить модель устройства** (*Сети и оборудование -> Устройства*). По умолчанию в системе занесено несколько производителей, но вы можете добавить и своих. Добавление нового вендора ни на что не влияет, разве что более удобоваримого восприятия информации. После этого можно добавлять устройства и привязывать к ним те самые шаблоны, по которым происходит авторизация.
![Добавление новой модели устройства](/images/cbackup_basics/5.png)
4. **Подсети** (*Сети и оборудование -> Подсети*). Этот шаг является необязательным в том случае, если все узлы вы собираетесь добавлять вручную. На деле же тут просто описывается подсеть вида 192.168.1.0/24 и к ней привязываются реквизиты. Переключатель "*Участвует в поиске*" позволяет включить или исключить данную подсеть для сканирования (которое в свою очередь служит тому самому механизму автоматического добавления новых железок).
![Создание подсети](/images/cbackup_basics/6.png)

